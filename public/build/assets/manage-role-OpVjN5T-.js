import{K as $,m as A,j as e,L as P}from"./app-PAcH8mEI.js";import{A as F,H as z}from"./app-layout-CYRkYMMk.js";import{I as u}from"./input-error-DhixQXJ9.js";import{B as E}from"./app-logo-icon-C1GCiWs0.js";import{I as b}from"./input-DocUmPqS.js";import{S as v}from"./switch-ccY8m7JO.js";import{f as M}from"./dateHelper-DeSP8uTY.js";import{t as U,r as B}from"./app-header-layout-0fU0bezq.js";import{z as H}from"./transition-DL3S_QgM.js";/* empty css            */import"./index-DQ1IlWpQ.js";import"./index-ClCDInp8.js";function ee({role:a,modules:f}){const w=[{title:"Roles",href:"/roles"},{title:a.name,href:`/roles/view/${a.id}`}],{auth:g}=$().props,C=g.user.roles,_=(s,i,o)=>{c(r=>{const t=r.permissions[s]||[],m=o?Array.from(new Set([...t,i])):t.filter(p=>p!==i);return{...r,permissions:{...r.permissions,[s]:m}}})},k=a.permissions??{},{data:n,setData:c,post:S,processing:D,errors:l,recentlySuccessful:R}=A({name:a.name,description:a.description,for_admin:a.for_admin,roleId:a.id,permissions:k}),T=()=>{const s=new Promise((i,o)=>{S(route("roles.update-permissions"),{preserveScroll:!0,onSuccess:r=>{const t=r.props.flash;t!=null&&t.error?o(t.error):i()},onError:()=>{o("Failed to update role permissions.")}})});U.promise(s,{loading:"Updating role permissions...",success:"Role permissions updated successfully!",error:i=>i,duration:5e3,description:M(new Date),descriptionClassName:"!text-gray-500",classNames:{success:"!text-green-700",error:"!text-red-700",loading:"!text-blue-700"}})};return e.jsxs(F,{breadcrumbs:w,children:[e.jsx(P,{title:`Manage ${a.name} Role`}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsx(z,{title:n.name,description:n.description}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-stretch gap-3 border-t text-sm font-medium",children:[e.jsxs("div",{className:"flex w-100 flex-col gap-0 border-r py-3 pr-3",children:[e.jsx("span",{children:"Name"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:"The name of the role. This will be displayed in the admin dashboard."}),e.jsx(u,{message:l.name,className:"mt-2 text-xs"})]}),e.jsx("div",{className:"my-auto py-3",children:e.jsx(b,{type:"text",className:"rounded border border-gray-300 px-2 py-1 text-sm focus:outline-none",defaultValue:n.name,onChange:s=>c("name",s.target.value),placeholder:"Name",name:"name",autoComplete:"name"})})]}),e.jsxs("div",{className:"flex items-stretch gap-3 border-t text-sm font-medium",children:[e.jsxs("div",{className:"flex w-100 flex-col gap-0 border-r py-3 pr-3",children:[e.jsx("span",{children:"Description"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:"The description of the role. This will be displayed in the admin dashboard."}),e.jsx(u,{message:l.description,className:"mt-2 text-xs"})]}),e.jsx("div",{className:"my-auto py-3",children:e.jsx(b,{type:"text",className:"rounded border border-gray-300 px-2 py-1 text-sm focus:outline-none",defaultValue:n.description,onChange:s=>c("description",s.target.value),placeholder:"Description",name:"description",autoComplete:"description"})})]}),e.jsxs("div",{className:"flex items-stretch gap-3 border-y text-sm font-medium",children:[e.jsxs("div",{className:"flex w-100 flex-col gap-0 border-r py-3 pr-3",children:[e.jsx("span",{children:"Admin Access"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:"Determines if the role can access the admin dashboard. If enabled, the role will have access to all modules and actions."}),e.jsx(u,{message:l.description,className:"mt-2 text-xs"})]}),e.jsx("div",{className:"my-auto py-3",children:e.jsx(v,{id:"for-admin",checked:!!n.for_admin,onCheckedChange:s=>{c("for_admin",!!s)}})})]}),e.jsx("span",{className:"py-2 font-semibold",children:"Module Permissions"}),n.for_admin?f.map((s,i)=>{const o=(r,t=0)=>{const m=r.available_actions??[],p=n.permissions[r.id]??[],I=t>0?{marginLeft:`${t*1}rem`}:{};return e.jsxs("div",{className:`flex items-stretch gap-3 ${i==f.length-1?"border-y":"border-t"} text-sm font-medium`,children:[e.jsxs("div",{className:"flex w-100 flex-col gap-0 border-r py-3 pr-3",children:[e.jsxs("span",{style:I,className:"flex items-center gap-2",children:[t>0&&e.jsx(B,{size:16}),r.name]}),e.jsx("span",{className:"text-muted-foreground text-xs",children:r.description})]}),e.jsx("div",{className:"my-auto flex gap-5 py-3",children:m.map(d=>{var y,N;const x=`${r.id}-${d}`,j=p.includes(d);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{id:x,checked:j,onCheckedChange:h=>{_(r.id,d,!!h)},disabled:!n.for_admin||j&&d==="can_view"&&((N=(y=g.permissions)==null?void 0:y[r.name])==null?void 0:N.can_view)!==1&&C.some(h=>h.id===a.id)}),e.jsx("label",{htmlFor:x,className:"text-sm font-medium",children:d.replace("can_","").replace("_"," ").toUpperCase()})]},x)})})]},r.id)};return s.children&&s.children.length>0?e.jsxs("div",{children:[o(s),s.children.map(r=>o(r,1))]},s.id):o(s)}):e.jsx("div",{children:e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"This role is not allowed to access the admin dashboard."})})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx(E,{type:"button",className:"rounded bg-black px-4 py-1 text-white hover:bg-gray-800",onClick:T,disabled:D,children:"Save Changes"}),e.jsx(H,{show:R,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-neutral-600",children:"Saved"})})]}),l.name&&e.jsx("span",{className:"text-sm font-medium text-red-500",children:l.name})]})]})]})}export{ee as default};
