import{K as R,r as j,m as V,j as e,L as B,S as Y}from"./app-PAcH8mEI.js";import{A as $,H as G}from"./app-layout-CYRkYMMk.js";import{D as J,f as Q}from"./format-BMAe8L_G.js";import{I as m}from"./input-error-DhixQXJ9.js";import{m as W,u as X,v as Z,K as ee,E as se,T as ae,A as re,a as te,b as ie,t as N}from"./app-header-layout-0fU0bezq.js";import{B as b,L as oe}from"./app-logo-icon-C1GCiWs0.js";import{D as C,a as le,b as D,c as I,d as S,e as A,f as U}from"./dialog-Be9wMSGQ.js";import{I as p}from"./input-DocUmPqS.js";import{L as u}from"./label-CY5Yq7-4.js";import{f as F}from"./dateHelper-DeSP8uTY.js";/* empty css            */import"./checkbox-D2uzdcW9.js";import"./index-DQ1IlWpQ.js";import"./index-ClCDInp8.js";const ne=[{title:"Users",href:"/users"}];function Ce({users:x,tableData:r,allUsersCount:P}){const{canCreate:k,canUpdate:_,canDelete:T}=W(),{auth:E,flash:de}=R().props,L=X(),[M,v]=j.useState(!1),[w,h]=j.useState(null),[q,l]=j.useState(!1),{data:n,setData:d,post:z,delete:O,processing:i,errors:c,reset:y}=V({name:"",email:"",password:"",password_confirmation:""}),H=s=>{s.preventDefault();const g=new Promise((t,o)=>{z(route("users.register-user"),{preserveScroll:!0,onSuccess:f=>{const a=f.props.flash;y(),v(!1),a!=null&&a.error?o(a.error):t()},onError:()=>{y("password","password_confirmation"),o()}})});N.promise(g,{loading:"Creating user...",success:"User created!",error:t=>t,duration:5e3,description:F(new Date),descriptionClassName:"!text-gray-500",classNames:{success:"!text-green-700",error:"!text-red-700",loading:"!text-blue-700"}})},K=s=>{const g=new Promise((t,o)=>{O(route("users.delete-user",s),{preserveScroll:!0,onSuccess:f=>{const a=f.props.flash;l(!1),h(null),a!=null&&a.error?o(a.error):t()},onError:()=>{l(!1),h(null),o("Failed to delete user.")}})});N.promise(g,{loading:"Deleting user...",success:"User deleted!",error:t=>t,duration:5e3,description:F(new Date),descriptionClassName:"!text-gray-500",classNames:{success:"!text-green-700",error:"!text-red-700",loading:"!text-blue-700"}})};return e.jsxs($,{breadcrumbs:ne,children:[e.jsx(B,{title:"Users"}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsx(G,{title:"Users",description:"Manage the users of this system"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"flex flex-col items-start justify-between gap-2 sm:flex-row sm:items-center",children:k("Users")&&e.jsx("div",{className:"flex w-full items-center justify-between gap-3 sm:w-max",children:e.jsxs(C,{open:M,onOpenChange:v,children:[e.jsx(le,{asChild:!0,children:e.jsxs(b,{className:"w-max",children:[e.jsx(Z,{}),"Add User"]})}),e.jsxs(D,{children:[e.jsxs(I,{children:[e.jsx(S,{children:"Add User"}),e.jsx(A,{children:"Fill out the form below to create a new user account."})]}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:H,children:[e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid",children:[e.jsx(u,{htmlFor:"name",children:"Name"}),e.jsx(p,{id:"name",type:"text",required:!0,autoFocus:!0,tabIndex:1,autoComplete:"name",value:n.name,onChange:s=>d("name",s.target.value),disabled:i,placeholder:"Full name"}),e.jsx(m,{message:c.name,className:"mt-2"})]}),e.jsxs("div",{className:"grid",children:[e.jsx(u,{htmlFor:"email",children:"Email address"}),e.jsx(p,{id:"email",type:"email",required:!0,tabIndex:2,autoComplete:"email",value:n.email,onChange:s=>d("email",s.target.value),disabled:i,placeholder:"email@example.com"}),e.jsx(m,{message:c.email})]}),e.jsxs("div",{className:"grid",children:[e.jsx(u,{htmlFor:"password",children:"Password"}),e.jsx(p,{id:"password",type:"password",required:!0,tabIndex:3,value:n.password,onChange:s=>d("password",s.target.value),disabled:i,placeholder:"Password"}),e.jsx(m,{message:c.password})]}),e.jsxs("div",{className:"grid",children:[e.jsx(u,{htmlFor:"password_confirmation",children:"Confirm password"}),e.jsx(p,{id:"password_confirmation",type:"password",required:!0,tabIndex:4,value:n.password_confirmation,onChange:s=>d("password_confirmation",s.target.value),disabled:i,placeholder:"Confirm password"}),e.jsx(m,{message:c.password_confirmation})]})]}),e.jsx(U,{children:e.jsxs(b,{type:"submit",className:"mt-2 w-full",tabIndex:5,disabled:i,children:[i&&e.jsx(oe,{className:"h-4 w-4 animate-spin"}),"Create account"]})})]}),e.jsxs("span",{className:"flex items-center justify-center gap-2 text-sm font-medium text-red-700",children:[e.jsx(ee,{size:16}),e.jsx("div",{children:"The user is required to change their password upon first login."})]})]})]})})}),e.jsx(J,{enableSearch:!0,searchDefaultValue:r.search,enableSelect:!0,onSelectionChange:s=>{},enableIndex:!0,indexFrom:x.from,headers:[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"activated_at",label:"Activated At"}],data:x.data,customData:[{key:"name",render:s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(re,{children:[s.avatar&&e.jsx(te,{src:`/storage/${s.avatar}`,alt:s.name,className:"size-8 rounded-full object-cover"}),e.jsx(ie,{children:L(s.name)})]}),e.jsx("span",{children:s.name})]})},{key:"activated_at",render:s=>s.activated_at?e.jsx("span",{children:Q(new Date(s.activated_at),"MMMM d, yyyy h:mm a")}):e.jsx("span",{className:"text-gray-500",children:"Not activated"})}],dataCount:P,filters:[{key:"verified",label:"Verified"},{key:"active",label:"Active"}],defaultFilters:r.filters,actions:[{label:"View User",className:"bg-[#3b5998] hover:bg-[#3b5998]/90",icon:e.jsx(se,{size:14}),showIf:s=>_("Users"),onClick:s=>Y.visit(route("users.view-user",s.id))},{label:"",className:"bg-[#983b3b] hover:bg-[#983b3b]/90",icon:e.jsx(ae,{size:14}),showIf:s=>T("Users")&&E.user.id!==s.id,onClick:s=>{h(s.id),l(!0)}}],paginationCurrentPage:r.page,paginationLastPage:x.last_page,baseRoute:"users",defaultSort:r.sort,defaultSortDirection:r.direction,defaultPerPage:r.perPage,perPagesDropdown:r.perPagesDropdown}),w&&e.jsx(C,{open:q,onOpenChange:l,children:e.jsx(D,{children:e.jsxs(I,{children:[e.jsx(S,{children:"Are you absolutely sure?"}),e.jsx(A,{children:"This action cannot be undone. This will permanently delete the account and remove their data."}),e.jsx(U,{children:e.jsx(b,{type:"submit",variant:"danger",onClick:()=>K(w),children:"Yes"})})]})})})]})]})]})}export{Ce as default};
