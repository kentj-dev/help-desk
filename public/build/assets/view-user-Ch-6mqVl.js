import{K as P,r as h,m as _,j as e,L as H,S as $}from"./app-PAcH8mEI.js";import{A as B,H as M}from"./app-layout-CYRkYMMk.js";import{C as V}from"./CropDialog-BC0JjRhn.js";import{I as u}from"./input-error-DhixQXJ9.js";import{m as q,u as K,X,A as f,a as w,b as g,t as y}from"./app-header-layout-0fU0bezq.js";import{B as G}from"./app-logo-icon-C1GCiWs0.js";import{C as J}from"./checkbox-D2uzdcW9.js";import{a as O,b as Q,c as W,d as Y,e as Z}from"./dialog-Be9wMSGQ.js";import{I as j}from"./input-DocUmPqS.js";import{S as ee}from"./scroll-area-Bc_avh2H.js";import{f as se}from"./dateHelper-DeSP8uTY.js";import{z as ae}from"./transition-DL3S_QgM.js";/* empty css            */import"./index-DQ1IlWpQ.js";import"./index-ClCDInp8.js";const je=({user:a,roles:v})=>{const{canUpdate:o}=q(),{auth:C}=P().props;C.user;const S=[{title:"Users",href:"/users"},{title:a.name,href:`/view-user/${a.id}`}],d=K(),[N,T]=h.useState(null),[U,b]=h.useState(!1),[m,D]=h.useState(""),k=s=>{var l;const r=(l=s.target.files)==null?void 0:l[0];if(!r)return;const t=new FileReader;t.onload=()=>{T(t.result),b(!0)},t.readAsDataURL(r)},I=s=>{i("new_avatar",s)},{data:c,setData:i,errors:x,post:A,processing:F,recentlySuccessful:L,reset:E}=_({name:a.name,new_avatar:null,email:a.email,rolesId:a.roles.map(s=>s.id)}),R=s=>{s.preventDefault();const r=new Promise((t,l)=>{A(route("users.update-user",a.id),{preserveScroll:!0,onSuccess:p=>{const n=p.props.flash;E("new_avatar"),n!=null&&n.error?l(n.error):t()},onError:()=>{l("Failed to update user.")}})});y.promise(r,{loading:"Updating user...",success:"User updated successfuly!",error:t=>t,description:se(new Date),descriptionClassName:"!text-gray-500",duration:5e3,classNames:{success:"!text-green-700",error:"!text-red-700",loading:"!text-blue-700"},position:"bottom-right"})},z=(s,r)=>{i(t=>{const l=r?[...t.rolesId,s]:t.rolesId.filter(p=>p!==s);return{...t,rolesId:l}})};return e.jsxs(B,{breadcrumbs:S,children:[e.jsx(H,{title:a.name}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsx(M,{title:a.name,description:a.email}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-stretch gap-3 border-t text-sm font-medium",children:[e.jsxs("div",{className:"flex w-100 flex-col gap-0 border-r py-3 pr-3",children:[e.jsx("span",{children:"Name"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:"The name of the user. This is the name that will be displayed on the user profile."}),e.jsx(u,{message:x.name,className:"mt-2 text-xs"})]}),e.jsx("div",{className:"my-auto py-3",children:e.jsx(j,{type:"text",className:"rounded border border-gray-300 px-2 py-1 text-sm focus:outline-none",defaultValue:c.name,onChange:s=>i("name",s.target.value),placeholder:"Name",name:"name",autoComplete:"name"})})]}),e.jsxs("div",{className:"flex items-stretch gap-3 border-t text-sm font-medium",children:[e.jsxs("div",{className:"flex w-100 flex-col gap-0 border-r py-3 pr-3",children:[e.jsx("span",{children:"Email"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:"The email of the user. This is the email that will be used to login to the user profile."}),e.jsx(u,{message:x.email,className:"mt-2 text-xs"})]}),e.jsx("div",{className:"my-auto py-3",children:e.jsx(j,{type:"email",id:"email",name:"email",value:c.email,placeholder:"Email",required:!0,onChange:s=>i("email",s.target.value),disabled:!o("Users"),className:"disabled:opacity-100",autoComplete:"email"})})]}),e.jsxs("div",{className:"flex items-stretch gap-3 border-t text-sm font-medium",children:[e.jsxs("div",{className:"flex w-100 flex-col gap-0 border-r py-3 pr-3",children:[e.jsx("span",{children:"Current Avatar"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:"The current avatar of the user."})]}),e.jsx("div",{className:"my-auto py-3",children:a.avatar?e.jsxs(X,{children:[e.jsx(O,{asChild:!0,children:e.jsxs(f,{className:"size-20 cursor-pointer rounded-md",children:[a.avatar&&e.jsx(w,{src:`/storage/${a.avatar}`,alt:a.name,className:"object-cover"}),e.jsx(g,{className:"rounded-md",children:d(a.name)})]})}),e.jsxs(Q,{className:"sm:max-w-[425px]",children:[e.jsxs(W,{children:[e.jsxs(Y,{children:[a.name,"'s Avatar"]}),e.jsx(Z,{children:a.email})]}),e.jsxs(f,{className:"size-full rounded-md",children:[a.avatar&&e.jsx(w,{src:`/storage/${a.avatar}`,alt:a.name,className:"object-cover"}),e.jsx(g,{children:d(a.name)})]})]})]}):e.jsx(f,{className:"size-20 rounded-md",children:e.jsx(g,{className:"rounded-md",children:d(a.name)})})})]}),o("Users")&&e.jsxs("div",{className:"flex items-stretch gap-3 border-t text-sm font-medium",children:[e.jsxs("div",{className:"flex w-100 flex-col gap-0 border-r py-3 pr-3",children:[e.jsx("span",{children:"New Avatar"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:"The new avatar of the user. This is the image that will be displayed on the user profile."}),e.jsx(u,{message:x.new_avatar,className:"mt-2 text-xs"})]}),e.jsx("div",{className:"my-auto py-3",children:e.jsx(j,{type:"file",id:"avatar",name:"avatar",accept:"image/*",onChange:k,disabled:!o("Users"),className:"disabled:opacity-100"})})]}),o("Users")&&e.jsxs("div",{className:"flex items-stretch gap-3 border-t text-sm font-medium",children:[e.jsxs("div",{className:"flex w-100 flex-col gap-0 border-r py-3 pr-3",children:[e.jsx("span",{children:"Password Reset"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:"The password reset link of the user. This is the link that will be used to reset the password of the user."})]}),e.jsx("div",{className:"my-auto py-3",children:e.jsx("button",{className:"cursor-pointer text-sm text-blue-500",onClick:s=>{s.preventDefault();const r=new Promise((t,l)=>{$.post(route("password.email"),{email:a.email},{preserveScroll:!0,onSuccess:()=>t(),onError:()=>l()})});y.promise(r,{loading:"Sending password reset link...",success:"Password reset link sent!",error:"Failed to send password reset link.",duration:5e3})},children:"Send password reset link"})})]}),e.jsxs("div",{className:"flex items-stretch gap-3 border-y text-sm font-medium",children:[e.jsxs("div",{className:"flex w-100 flex-col gap-0 border-r py-3 pr-3",children:[e.jsx("span",{children:"Roles"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:"The roles of the user. This is the list of roles that the user has. The user will have access to the modules that are assigned to the roles."})]}),e.jsxs("div",{className:"my-auto py-3",children:[e.jsx("input",{name:"role-search",type:"text",placeholder:"Search for role",className:"border-b text-xs focus:outline-none disabled:opacity-100",value:m,onChange:s=>D(s.target.value),disabled:!o("Users")}),e.jsx(ee,{className:"flex max-h-52 w-48 flex-col gap-2 rounded p-2",id:"roles",children:v.filter(s=>s.name.toLowerCase().includes(m.toLowerCase())).length>0?v.filter(s=>s.name.toLowerCase().includes(m.toLowerCase())).map(s=>e.jsxs("div",{className:"mb-1 flex items-center gap-2 text-sm font-medium",children:[e.jsx(J,{id:s.id,checked:c.rolesId.includes(s.id),onCheckedChange:r=>z(s.id,!!r),disabled:!o("Users")}),e.jsx("label",{htmlFor:s.id,className:"text-sm leading-none font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:s.name})]},s.id)):e.jsx("p",{className:"text-muted-foreground text-xs italic",children:"No role found."})})]})]}),o("Users")&&e.jsxs("div",{className:"flex items-center gap-2 pt-3",children:[e.jsx(G,{type:"submit",className:"rounded bg-black px-4 py-1 text-white hover:bg-gray-800",disabled:F,onClick:R,children:"Update User"}),e.jsx(ae,{show:L,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-neutral-600",children:"Saved"})})]})]})]}),N&&e.jsx(V,{imageSrc:N,open:U,onClose:()=>b(!1),onCropped:I})]})};export{je as default};
